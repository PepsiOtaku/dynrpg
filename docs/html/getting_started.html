<!-- HTML header for doxygen 1.10.0-->
<!DOCTYPE html
  PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "https://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" lang="en-US">
<head>
  <meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=11" />
  <meta name="generator" content="Doxygen 1.12.0" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>DynRPG: Getting Started</title>
  <link href="tabs.css" rel="stylesheet" type="text/css" />
  <script type="text/javascript" src="jquery.js"></script>
  <script type="text/javascript" src="dynsections.js"></script>
  <link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
  <link href="doxygen.css" rel="stylesheet" type="text/css" />
  <link rel="icon" href="favicon.ico" type="image/x-icon" />
</head>
<body>
    <div id="top"><!-- do not remove this div, it is closed by doxygen! -->
      <div id="titlearea">
        <table cellspacing="0" cellpadding="0">
          <tbody>
            <tr id="projectrow">
              <td id="projectlogo"><img alt="Logo" src="DynRPG_logo_webPepsiOtaku.png"  /></td>
              <td id="projectalign">
                <div id="projectname">DynRPG<span
                    id="projectnumber">&#160;v0.32 Unofficial</span>
                </div>
                <div id="projectbrief">Plugin SDK</div>
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <!-- end header part -->
<!-- Generated by Doxygen 1.12.0 -->
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li class="current"><a href="pages.html"><span>Related&#160;Pages</span></a></li>
      <li><a href="topics.html"><span>Topics</span></a></li>
      <li><a href="annotated.html"><span>Classes</span></a></li>
      <li><a href="examples.html"><span>Examples</span></a></li>
    </ul>
  </div>
<script type="text/javascript">
/* @license magnet:?xt=urn:btih:d3d9a9a6595521f9666a5e94cc830dab83b65699&amp;dn=expat.txt MIT */
$(function(){ initResizable(false); });
/* @license-end */
</script>
</div><!-- top -->
<div id="doc-content">
<div><div class="header">
  <div class="headertitle"><div class="title">Getting Started</div></div>
</div><!--header-->
<div class="contents">
<div class="textblock"><dl class="section note"><dt>Note</dt><dd>This page describes how to get started with the <b>SDK</b>. If you want to know how to get started with the <b>Patch</b>, see <a class="el" href="patch.html">The Patch</a>.</dd></dl>
<h1><a class="anchor" id="sdk_preconditions"></a>
The right C++ Compiler</h1>
<p>The DynRPG SDK works on a very low level. This means, small differences between compilers can break everything. The DynRPG was developed and tested using <a href="http://gcc.gnu.org/">GCC</a>, thus you should use GCC too. This DynRPG version only works with GCC version 4.7.1 and higher. You might use the <a href="http://www.codeblocks.org">Code::Blocks</a> IDE, for example.</p>
<h1><a class="anchor" id="sdk_installation"></a>
Installation</h1>
<p>Installing the SDK is easy - all you need to do is copying the files from the <code>include</code> and <code>lib</code> directories of the download archive into the corresponding folders of your compiler environment.</p>
<h1><a class="anchor" id="sdk_header"></a>
Header and library</h1>
<p>In order to use the DynRPG in your C++ project, you need to include <code>DynRPG/DynRPG.h</code>: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;DynRPG/DynRPG.h&gt;</span></div>
</div><!-- fragment --> <dl class="section warning"><dt>Warning</dt><dd>If you use more than one code module, you need to put the following line before the include statement in all modules except one: <div class="fragment"><div class="line"><span class="preprocessor">#define NOT_MAIN_MODULE</span></div>
</div><!-- fragment --></dd></dl>
<p>DynRPG automatically creates a <code>DllMain</code> function for you which stores the plugin's instance handle in a global variable called <code>hInstance</code>. You can suppress this behaviour by defining <code>CUSTOM_DLLMAIN</code> before including the header file.</p>
<p>The header file automatically includes the headers <code>string</code>, <code>map</code>, <code>windows.h</code> because they are needed for the declarations.</p>
<dl class="section warning"><dt>Warning</dt><dd>Since the RPG Maker is Non-Unicode, your plugin should be Non-Unicode too!</dd></dl>
<p>You also need to add the library <code>DynRPG</code> (<code>libDynRPG.a</code>) to your project. See your IDE's help file if you don't know how to do this. (Normally you need to add the parameter <code>-lDynRPG</code> to the linker's command line.)</p>
<h1><a class="anchor" id="sdk_callbacks"></a>
Callbacks</h1>
<p>Together with the <a class="el" href="#sdk_game_objects">Game objects</a>, callbacks are important ways to interface your plugin with the game. Callbacks are functions which you can define in your plugin. On certain events in the game (for example, a picture is drawn - see <a class="el" href="group__callbacks.html#gac6ad686df799b1dd99171611a62fd493">onDrawPicture</a>) certain callbacks will be called by DynRPG. Callbacks either return <code>void</code> or <code>bool</code>. If you return <code>false</code> in <code>bool</code> callbacks, this will prevent other plugins from receiveing the same notification and sometimes it will also prevent some event from happening in the game. For example, if you return <code>false</code> from your <code>onDrawPicture</code> callback, the picture won't be drawn and other plugins (after yours) won't receive <code>onDrawPicture</code> for that picture.</p>
<p>You only need to define those callback functions which you actually use.</p>
<p>For a list of available callbacks, click here: <a class="el" href="group__callbacks.html">Callbacks</a></p>
<h1><a class="anchor" id="sdk_game_objects"></a>
Game objects</h1>
<p>The game objects are the second important way to interface your plugin with the game. Most of the <a class="el" href="namespace_r_p_g.html" title="The one and only namespace in which all DynRPG classes, variables and functions reside,...">RPG</a> classes are tied to a game object and should only be used through it. For example, the game object tied to <a class="el" href="class_r_p_g_1_1_actor.html" title="Used for the data of actors which can be changed in-game.">RPG::Actor</a> is called <a class="el" href="group__game__objects.html#ga87c6f54305a283d34aac70178c17932b" title="Array of actors from the database, used for properties which can change in-game.">RPG::actors</a>.</p>
<p>Game objects represent certain "things" in the game. For example, the <a class="el" href="group__game__objects.html#ga0f7cb4c7d2a82886fbe9326ea98ed8a9" title="The current map environment (camera, events, etc.)">RPG::map</a> object (the corresponding class is called <a class="el" href="class_r_p_g_1_1_map.html" title="Used for accessing and manipulating the current map environment.">RPG::Map</a>) represents the current map. So, to get the width of the current map, you may call the <a class="el" href="class_r_p_g_1_1_map.html#af7cac99b6f26b31f6e5e657ed7b52c24" title="Returns the width of the current map.">RPG::Map::getWidth</a> function like this: </p><div class="fragment"><div class="line"><span class="keywordtype">int</span> mapWidth = <a class="code hl_variable" href="group__game__objects.html#ga0f7cb4c7d2a82886fbe9326ea98ed8a9">RPG::map</a>-&gt;<a class="code hl_function" href="class_r_p_g_1_1_map.html#af7cac99b6f26b31f6e5e657ed7b52c24">getWidth</a>();</div>
<div class="ttc" id="aclass_r_p_g_1_1_map_html_af7cac99b6f26b31f6e5e657ed7b52c24"><div class="ttname"><a href="class_r_p_g_1_1_map.html#af7cac99b6f26b31f6e5e657ed7b52c24">RPG::Map::getWidth</a></div><div class="ttdeci">int getWidth()</div><div class="ttdoc">Returns the width of the current map.</div></div>
<div class="ttc" id="agroup__game__objects_html_ga0f7cb4c7d2a82886fbe9326ea98ed8a9"><div class="ttname"><a href="group__game__objects.html#ga0f7cb4c7d2a82886fbe9326ea98ed8a9">RPG::map</a></div><div class="ttdeci">Map *&amp; map</div><div class="ttdoc">The current map environment (camera, events, etc.)</div></div>
</div><!-- fragment --><p>For a list of available game objects, click here: <a class="el" href="group__game__objects.html">Game objects</a></p>
<h1><a class="anchor" id="sdk_hello_world"></a>
Hello World - Our first plugin</h1>
<p>It's time to create our first plugin. It's going to be <em>really</em> simple - all it is going to do is displaying a message box asking whether we really want to play before actually starting the game. We'll call it <code>are_you_sure</code>.</p>
<p>First, create an RPG Maker 2003 project to test the plugin and apply <a class="el" href="patch.html">The Patch</a> to it. Then, create a new C++ project in your favorite IDE and select <b>DLL</b> as project type. It might be convinient to store the source code in a subfolder of the <code>DynPlugins</code> directory of your test project and set the compiler output directory to the <code>DynPlugins</code> directory.</p>
<dl class="section warning"><dt>Warning</dt><dd>If you are using Windows Vista or Windows 7, make sure you have write access to your project directory! You better put it into your <code>Documents</code> folder. Otherwise make sure you run both RPG Maker 2003 and your IDE (e.g. Code::Blocks) with administrator privileges!</dd></dl>
<p>Okay, I'll be give a bit more step-by-step instructions now - of course you can do it differently if you know how, but this should help people who are not familiar with Code::Blocks to get started: </p><ol>
<li>
Download Code::Blocks <a href="http://www.codeblocks.org/downloads/binaries">here</a>. Make sure you select the "bigger" package which contains MinGW which includes the GNU C++ compiler (which we need). </li>
<li>
Install Code::Blocks. It's okay if you don't change the default feature selection. Please remember or write down to path you are installing Code::Blocks to (e.g. <code>C:\Program Files (x86)\CodeBlocks</code>)! </li>
<li>
Open the path where you installed Code::Blocks in Windows Explorer. </li>
<li>
There should be a subfolder called <code>MinGW</code>. Open it. There should be folders called <code>include</code> and <code>lib</code> inside, among others. </li>
<li>
Copy the <code>include</code> and <code>lib</code> folders from your DynRPG download (in the <code>sdk</code> subfolder) into the <code>MinGW</code> folder. Confirm merging the folders. </li>
<li>
Start Code::Blocks. </li>
<li>
Click <code>Create new project...</code>. </li>
<li>
Select <code>Dynamic Link Library</code> and click <code>Go</code>. </li>
<li>
Click <code>Next</code>. </li>
<li>
Enter the name of your plugin (here: <code>are_you_sure</code>). To avoid problems later, do not use spaces. </li>
<li>
In the second field, select the <code>DynPlugins</code> folder of your RM2k3 test project. The actual filename of the Code::Blocks project file (shown in the last field) should be similar to this: <code>C:\Users\</code><em><code>My Username</code></em><code>\Documents\</code><em><code>My Test Project</code></em><code>\DynPlugins\are_you_sure\are_you_sure.cbp</code> </li>
<li>
Click <code>Next</code>. </li>
<li>
Make sure <code>GNU GCC Compiler</code> is selected in the first field. </li>
<li>
Uncheck <code>Create "Debug" configuration</code>. <dl class="section note"><dt>Note</dt><dd>Of course, if you know how you use them, you may create debug builds too. As said, these step-by-step instructions are for beginners. </dd></dl>
</li>
<li>
Change the <code>Output dir.</code> at the <code>"Release" options</code> to <code>..\</code> (two dots and then a backslash). This will create the plugin DLL directly in the <code>DynRPG</code> folder if you have followed step 11 correctly. </li>
<li>
Click <code>Finish</code>. </li>
<li>
Open the <code>Project</code> menu, select <code>Build options...</code>. </li>
<li>
Go to the <code>Linker settings</code> tab. </li>
<li>
At the <code>Link libraries</code> section, click <code>Add</code>. </li>
<li>
Enter <code>DynRPG</code> and click <code>OK</code>. </li>
<li>
Go to the pre/post build steps tab. </li>
<li>
Enter the following line into the bottom box: <code>cmd /c del ..*.a &amp; del ..*.def</code> </li>
<li>
Click <code>OK</code> again. </li>
<li>
Open the <code>Project</code> menu, select <code>Set programs' arguments...</code>. </li>
<li>
Click the button at the right end of the <code>Host application</code> field and select your game's <code>RPG_RT.exe</code> file. This will allow you to use the <code>Run</code> and <code>Build and run</code> buttons in Code::Blocks to run your game. </li>
<li>
If you want the game to automatically start in windowed test play mode when you start it from Code::Blocks, put <code>TestPlay ShowTitle Window</code> into the <code>Program arguments</code> field. </li>
<li>
Click <code>OK</code>. </li>
<li>
Now, Code::Blocks has created two files for you: <code>main.cpp</code> (find it in the <code>Sources</code> folder of the tree view) and <code>main.h</code> (find it in the <code>Headers</code> folder of the tree view). Delete the contents of both of them. In our examples, we don't need the <code>main.h</code> file at all, you may right-click it and choose <code>Remove file from project</code> if you want. In <code>main.cpp</code>, copy the code provided below:</li>
</ol>
<div class="fragment"><div class="line"><span class="preprocessor">#include &lt;DynRPG/DynRPG.h&gt;</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// Handler called on startup</span></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="group__callbacks.html#ga8a8edd989b9169752c0239bbadb3f9fd">onStartup</a>(<span class="keywordtype">char</span> *pluginName) {</div>
<div class="line">    <span class="keywordflow">if</span>(MessageBox(</div>
<div class="line">        NULL, <span class="comment">// We don&#39;t need a window handle</span></div>
<div class="line">        <span class="stringliteral">&quot;This is such a haaaaard game. Are you SURE you want to play it now?&quot;</span>, <span class="comment">// Text</span></div>
<div class="line">        <span class="stringliteral">&quot;The Are You Sure Plugin&quot;</span>, <span class="comment">// Title</span></div>
<div class="line">        MB_YESNO | MB_ICONQUESTION <span class="comment">// Flags (yes/no buttons and question icon)</span></div>
<div class="line">    ) == IDYES) {</div>
<div class="line">        <span class="comment">// The user clicked &quot;Yes&quot;, we may continue</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">true</span>;</div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">// The user clicked &quot;No&quot;, so we need to abort</span></div>
<div class="line">        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="agroup__callbacks_html_ga8a8edd989b9169752c0239bbadb3f9fd"><div class="ttname"><a href="group__callbacks.html#ga8a8edd989b9169752c0239bbadb3f9fd">onStartup</a></div><div class="ttdeci">bool onStartup(char *pluginName)</div><div class="ttdoc">Called when the plugin was loaded.</div></div>
</div><!-- fragment --><p> Okay, that's really simple. It uses Windows' <a href="http://msdn.microsoft.com/en-us/library/windows/desktop/ms645505%28v=vs.85%29.aspx">MessageBox</a> function to display a message. If the user clicked "Yes", the game will continue, otherwise it will not start.</p>
<p>This simple plugin uses the <a class="el" href="group__callbacks.html#ga8a8edd989b9169752c0239bbadb3f9fd">onStartup</a> callback. This callback is called before the game starts. If you return <code>false</code> in this callback, the game won't start. (You only need to define those callbacks which you want to use.)</p>
<p>So, if you compile this plugin, make sure the DLL file (<code>are_you_sure.dll</code>) was put into the <code>DynPlugins</code> directory and your test project was successfully patched using <a class="el" href="patch.html">The Patch</a>, you should see our message box when you start the game.</p>
<h1><a class="anchor" id="sdk_condition_icons"></a>
Condition Icons - More Advanced</h1>
<p>Enough of nonsense. Now we are going to create something useful. We are going to create a plugin which displays the conditions of actors and monsters over their head, as icons.</p>
<p>These are its features: </p><ul>
<li>
It will read the filenames of the icons from the configuration file. </li>
<li>
It will load the files on demand (when they are needed the first time). </li>
<li>
It will display them over the head of the battlers, horizontally centered, vertically aligned at the bottom (in case the images don't have the same height). </li>
<li>
It will disable the default info window which is shown on target selection so that we don't show the conditions twice.</li>
</ul>
<p>First, in the <a class="el" href="group__callbacks.html#ga8a8edd989b9169752c0239bbadb3f9fd">onStartup</a> handler, we will load the configuration and store it in a global variable called <code>configuration</code>.</p>
<p>Then, in the <a class="el" href="group__callbacks.html#ga7156e34fef971c0ef925491981bb33c4">onBattlerDrawn</a> handler, we will iterate through all conditions the battler has, check if the images we need are loaded, if not, load them. We will also calculate the total width of all icons for that battler here. Then we will draw all the icons and finally clear the <a class="el" href="class_r_p_g_1_1_battler.html#ad21309b7603cb479642232a913e3d41b" title="Conditions which will be displayed in the info window (see details)">RPG::Battler::displayedConditions</a> array so that no info window is displayed when the target selection is active.</p>
<p>Finally, in the <a class="el" href="group__callbacks.html#gaf7dcec3988ba4d873f365b75373e5b09">onExit</a> handler, we will unload all images.</p>
<p>This is the content of our <code>condition_icons.cpp</code> file: </p><div class="fragment"><div class="line"><span class="preprocessor">#include &lt;DynRPG/DynRPG.h&gt;</span></div>
<div class="line"><span class="preprocessor">#include &lt;sstream&gt;</span> <span class="comment">// For std::stringstream</span></div>
<div class="line"> </div>
<div class="line"><span class="comment">// We store the configuration here</span></div>
<div class="line">std::map&lt;std::string, std::string&gt; configuration;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// We store the images of the conditions here</span></div>
<div class="line">std::map&lt;int, RPG::Image *&gt; images;</div>
<div class="line"> </div>
<div class="line"><span class="comment">// This handler is called on startup</span></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="group__callbacks.html#ga8a8edd989b9169752c0239bbadb3f9fd">onStartup</a>(<span class="keywordtype">char</span> *pluginName) {</div>
<div class="line">    <span class="comment">// We load the configuration from the DynRPG.ini file here</span></div>
<div class="line">    configuration = <a class="code hl_function" href="namespace_r_p_g.html#a384f30c4af9e6144612a638236ae0a79">RPG::loadConfiguration</a>(pluginName);</div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// Don&#39;t forget to return true so that the start of the game will continue!</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// This handler is called after a battler is drawn</span></div>
<div class="line"><span class="keywordtype">bool</span> <a class="code hl_function" href="group__callbacks.html#ga7156e34fef971c0ef925491981bb33c4">onBattlerDrawn</a>(<a class="code hl_class" href="class_r_p_g_1_1_battler.html">RPG::Battler</a> *battler, <span class="keywordtype">bool</span> isMonster, <span class="keywordtype">int</span> <span class="keywordtype">id</span>) {</div>
<div class="line">    <span class="keywordtype">int</span> totalWidth = 0; <span class="comment">// We store the total width of the condition icons here</span></div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We loop through all the elements of the battler&#39;s &quot;conditions&quot; array here</span></div>
<div class="line">    <span class="comment">// Note that the &quot;condition&quot; array is one-based, thus we start at index 1</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt;= battler-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_battler.html#aa2e8d085d0500808bb96928bbef6093e">conditions</a>.<a class="code hl_variable" href="class_r_p_g_1_1_d_array.html#a286160dd2eb0f091ae7a32f3b01dc72a">size</a>; i++) {</div>
<div class="line">        <span class="comment">// If the battler has the condition (see documentation)...</span></div>
<div class="line">        <span class="keywordflow">if</span>(battler-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_battler.html#aa2e8d085d0500808bb96928bbef6093e">conditions</a>[i] &gt; 0) {</div>
<div class="line">            <span class="comment">// If the image isn&#39;t loaded yet...</span></div>
<div class="line">            <span class="keywordflow">if</span>(!images[i]) {</div>
<div class="line">                <span class="comment">// First, we create an RPG::Image object</span></div>
<div class="line">                images[i] = <a class="code hl_function" href="class_r_p_g_1_1_image.html#a1a2371c3344cad4caf367182f9e56b84">RPG::Image::create</a>();</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// Yes, we want to use the transparent color</span></div>
<div class="line">                images[i]-&gt;useMaskColor = <span class="keyword">true</span>;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// Now, we put the key name for the configuration entry together</span></div>
<div class="line">                <span class="comment">// It should be &quot;Condition12&quot; for condition 12, for example</span></div>
<div class="line">                std::stringstream keyName;</div>
<div class="line">                keyName &lt;&lt; <span class="stringliteral">&quot;Condition&quot;</span> &lt;&lt; i;</div>
<div class="line"> </div>
<div class="line">                <span class="comment">// Now, we try to load the image. If loading the image fails,</span></div>
<div class="line">                <span class="comment">// nothing special will happen (because of the &quot;false&quot; at the</span></div>
<div class="line">                <span class="comment">// &quot;showErrors&quot; parameter), the image will just be empty.</span></div>
<div class="line">                images[i]-&gt;loadFromFile(configuration[keyName.str()], <span class="keyword">false</span>);</div>
<div class="line">            }</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// We add the image&#39;s width to the total width</span></div>
<div class="line">            totalWidth += images[i]-&gt;width;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Now we need to know the Y coordinate of the top of the battler</span></div>
<div class="line">    <span class="keywordtype">int</span> topY;</div>
<div class="line">    <span class="keywordflow">if</span>(isMonster) {</div>
<div class="line">        <span class="comment">// It is a monster. We just use the monster&#39;s image to find out</span></div>
<div class="line">        <span class="comment">// its size.</span></div>
<div class="line">        <a class="code hl_class" href="class_r_p_g_1_1_monster.html">RPG::Monster</a> *monster = (<a class="code hl_class" href="class_r_p_g_1_1_monster.html">RPG::Monster</a> *)battler; <span class="comment">// First, we cast the &quot;battler&quot; to a &quot;Monster&quot;</span></div>
<div class="line">        topY = monster-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_battler.html#a59839350ec655946e823f1bc8800587d">y</a> - monster-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_monster.html#a5e6939fc9a4b0001976eb66b18331305">image</a>-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_image.html#a14f857491e64e2078d82e8fcece22b47">height</a> / 2; <span class="comment">// Now we calculate the top position</span></div>
<div class="line">    } <span class="keywordflow">else</span> {</div>
<div class="line">        <span class="comment">// Okay, since we don&#39;t have a way to find out the size of an actor&#39;s</span></div>
<div class="line">        <span class="comment">// battle graphic, we will just &quot;guess&quot; that it&#39;s a normal BattleCharSet</span></div>
<div class="line">        <span class="comment">// which is 48 pixels tall.</span></div>
<div class="line">        <span class="comment">// In a &quot;good&quot; plugin, there would be a way to set the actual height</span></div>
<div class="line">        <span class="comment">// for each actor in the configuration, but this would be too much</span></div>
<div class="line">        <span class="comment">// for this tutorial.</span></div>
<div class="line">        topY = battler-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_battler.html#a59839350ec655946e823f1bc8800587d">y</a> - 48 / 2;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// We will use this variable to store the current X coordinate while we</span></div>
<div class="line">    <span class="comment">// draw the images. We will increase this variable every time we draw an</span></div>
<div class="line">    <span class="comment">// image.</span></div>
<div class="line">    <span class="keywordtype">int</span> currentX = battler-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_battler.html#a2c279272e66fd1f79f7bc151cbbbc4ba">x</a> - totalWidth / 2;</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Okay, let&#39;s loop again through the conditions. This is necessary</span></div>
<div class="line">    <span class="comment">// because we first had to find out the total width before we could</span></div>
<div class="line">    <span class="comment">// start drawing the images. Now we will draw them.</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 1; i &lt;= battler-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_battler.html#aa2e8d085d0500808bb96928bbef6093e">conditions</a>.<a class="code hl_variable" href="class_r_p_g_1_1_d_array.html#a286160dd2eb0f091ae7a32f3b01dc72a">size</a>; i++) {</div>
<div class="line">        <span class="comment">// If the battler has the condition (see documentation)...</span></div>
<div class="line">        <span class="keywordflow">if</span>(battler-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_battler.html#aa2e8d085d0500808bb96928bbef6093e">conditions</a>[i] &gt; 0) {</div>
<div class="line">            <span class="comment">// Okay, here we actually draw the image on the screen!</span></div>
<div class="line">            <a class="code hl_variable" href="group__game__objects.html#ga79ab87216775ec74cb63127296311fef">RPG::screen</a>-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_screen.html#a5b8212bbbfdcf8eb064038b542fa2f47">canvas</a>-&gt;<a class="code hl_function" href="class_r_p_g_1_1_canvas.html#a37bb56fb355bafaf1dcf93c0c0ab946c">draw</a>(currentX, topY - images[i]-&gt;height, images[i]);</div>
<div class="line"> </div>
<div class="line">            <span class="comment">// And we increase the current X coordinate.</span></div>
<div class="line">            currentX += images[i]-&gt;width;</div>
<div class="line">        }</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="comment">// Clear the condition cache which is normally used to determine which</span></div>
<div class="line">    <span class="comment">// conditions should be shown in the &quot;info window&quot; on top of the screen</span></div>
<div class="line">    <span class="comment">// during target selection (we don&#39;t need to display the conditions twice!)</span></div>
<div class="line">    <span class="keywordflow">for</span>(<span class="keywordtype">int</span> i = 0; i &lt; 5; i++) {</div>
<div class="line">        battler-&gt;<a class="code hl_variable" href="class_r_p_g_1_1_battler.html#ad21309b7603cb479642232a913e3d41b">displayedConditions</a>[i] = 0;</div>
<div class="line">    }</div>
<div class="line"> </div>
<div class="line">    <span class="keywordflow">return</span> <span class="keyword">true</span>; <span class="comment">// It&#39;s okay that the battler is drawn, so we return true. Don&#39;t forget that!</span></div>
<div class="line">}</div>
<div class="line"> </div>
<div class="line"><span class="comment">// This handler is called when the game exits</span></div>
<div class="line"><span class="keywordtype">void</span> <a class="code hl_function" href="group__callbacks.html#gaf7dcec3988ba4d873f365b75373e5b09">onExit</a>() {</div>
<div class="line">    <span class="comment">// We will unload all images here.</span></div>
<div class="line">    <span class="comment">// If you are not familiar with C++ iterators: This &quot;for&quot; loop just iterates</span></div>
<div class="line">    <span class="comment">// through all items in &quot;images&quot;.</span></div>
<div class="line">    <span class="keywordflow">for</span>(std::map&lt;int, RPG::Image *&gt;::const_iterator iter = images.begin(); iter != images.end(); ++iter ) {</div>
<div class="line">        <span class="comment">// The reason we don&#39;t use images[iter-&gt;first] instead of iter-&gt;second</span></div>
<div class="line">        <span class="comment">// is that RPG::Image::destroy also takes a reference and sets the</span></div>
<div class="line">        <span class="comment">// parameter to zero at the end.</span></div>
<div class="line">        <a class="code hl_function" href="class_r_p_g_1_1_image.html#a77db167e3c62337c0725da58b9822225">RPG::Image::destroy</a>(images[iter-&gt;first]);</div>
<div class="line">    }</div>
<div class="line">}</div>
<div class="ttc" id="aclass_r_p_g_1_1_battler_html"><div class="ttname"><a href="class_r_p_g_1_1_battler.html">RPG::Battler</a></div><div class="ttdoc">Used for entities participating in battle, i.e. actors and monsters.</div><div class="ttdef"><b>Definition</b> Battler.h:27</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_battler_html_a2c279272e66fd1f79f7bc151cbbbc4ba"><div class="ttname"><a href="class_r_p_g_1_1_battler.html#a2c279272e66fd1f79f7bc151cbbbc4ba">RPG::Battler::x</a></div><div class="ttdeci">int x</div><div class="ttdoc">Current X coordinate (centered)</div><div class="ttdef"><b>Definition</b> Battler.h:96</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_battler_html_a59839350ec655946e823f1bc8800587d"><div class="ttname"><a href="class_r_p_g_1_1_battler.html#a59839350ec655946e823f1bc8800587d">RPG::Battler::y</a></div><div class="ttdeci">int y</div><div class="ttdoc">Current Y coordinate (centered)</div><div class="ttdef"><b>Definition</b> Battler.h:97</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_battler_html_aa2e8d085d0500808bb96928bbef6093e"><div class="ttname"><a href="class_r_p_g_1_1_battler.html#aa2e8d085d0500808bb96928bbef6093e">RPG::Battler::conditions</a></div><div class="ttdeci">DArray&lt; short, 1 &gt; conditions</div><div class="ttdoc">Turns elapsed in a certain condition (see details)</div><div class="ttdef"><b>Definition</b> Battler.h:73</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_battler_html_ad21309b7603cb479642232a913e3d41b"><div class="ttname"><a href="class_r_p_g_1_1_battler.html#ad21309b7603cb479642232a913e3d41b">RPG::Battler::displayedConditions</a></div><div class="ttdeci">int displayedConditions[5]</div><div class="ttdoc">Conditions which will be displayed in the info window (see details)</div><div class="ttdef"><b>Definition</b> Battler.h:141</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_canvas_html_a37bb56fb355bafaf1dcf93c0c0ab946c"><div class="ttname"><a href="class_r_p_g_1_1_canvas.html#a37bb56fb355bafaf1dcf93c0c0ab946c">RPG::Canvas::draw</a></div><div class="ttdeci">void draw(int x, int y, RPG::Image *image, int srcX=0, int srcY=0, int srcWidth=-1, int srcHeight=-1)</div><div class="ttdoc">Draws an RPG::Image or a part of it onto the canvas.</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_d_array_html_a286160dd2eb0f091ae7a32f3b01dc72a"><div class="ttname"><a href="class_r_p_g_1_1_d_array.html#a286160dd2eb0f091ae7a32f3b01dc72a">RPG::DArray::size</a></div><div class="ttdeci">int size</div><div class="ttdoc">Size of the array.</div><div class="ttdef"><b>Definition</b> DArray.h:13</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_image_html_a14f857491e64e2078d82e8fcece22b47"><div class="ttname"><a href="class_r_p_g_1_1_image.html#a14f857491e64e2078d82e8fcece22b47">RPG::Image::height</a></div><div class="ttdeci">int height</div><div class="ttdoc">Height of the image.</div><div class="ttdef"><b>Definition</b> Image.h:47</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_image_html_a1a2371c3344cad4caf367182f9e56b84"><div class="ttname"><a href="class_r_p_g_1_1_image.html#a1a2371c3344cad4caf367182f9e56b84">RPG::Image::create</a></div><div class="ttdeci">static Image * create()</div><div class="ttdoc">Creates an empty image.</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_image_html_a77db167e3c62337c0725da58b9822225"><div class="ttname"><a href="class_r_p_g_1_1_image.html#a77db167e3c62337c0725da58b9822225">RPG::Image::destroy</a></div><div class="ttdeci">static void destroy(Image *&amp;image)</div><div class="ttdoc">Destroys an image.</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_monster_html"><div class="ttname"><a href="class_r_p_g_1_1_monster.html">RPG::Monster</a></div><div class="ttdoc">Used for monsters as subtype of battlers.</div><div class="ttdef"><b>Definition</b> Monster.h:16</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_monster_html_a5e6939fc9a4b0001976eb66b18331305"><div class="ttname"><a href="class_r_p_g_1_1_monster.html#a5e6939fc9a4b0001976eb66b18331305">RPG::Monster::image</a></div><div class="ttdeci">Image * image</div><div class="ttdoc">The image of the monster's graphic.</div><div class="ttdef"><b>Definition</b> Monster.h:20</div></div>
<div class="ttc" id="aclass_r_p_g_1_1_screen_html_a5b8212bbbfdcf8eb064038b542fa2f47"><div class="ttname"><a href="class_r_p_g_1_1_screen.html#a5b8212bbbfdcf8eb064038b542fa2f47">RPG::Screen::canvas</a></div><div class="ttdeci">Canvas * canvas</div><div class="ttdoc">RPG::Canvas which should be used for drawing on the screen.</div><div class="ttdef"><b>Definition</b> Screen.h:37</div></div>
<div class="ttc" id="agroup__callbacks_html_ga7156e34fef971c0ef925491981bb33c4"><div class="ttname"><a href="group__callbacks.html#ga7156e34fef971c0ef925491981bb33c4">onBattlerDrawn</a></div><div class="ttdeci">bool onBattlerDrawn(RPG::Battler *battler, bool isMonster, int id)</div><div class="ttdoc">Called after a battler was drawn (or supposed to be drawn)</div></div>
<div class="ttc" id="agroup__callbacks_html_gaf7dcec3988ba4d873f365b75373e5b09"><div class="ttname"><a href="group__callbacks.html#gaf7dcec3988ba4d873f365b75373e5b09">onExit</a></div><div class="ttdeci">void onExit()</div><div class="ttdoc">Called before the game exits.</div></div>
<div class="ttc" id="agroup__game__objects_html_ga79ab87216775ec74cb63127296311fef"><div class="ttname"><a href="group__game__objects.html#ga79ab87216775ec74cb63127296311fef">RPG::screen</a></div><div class="ttdeci">RPG::Screen *&amp; screen</div><div class="ttdoc">The screen, including window properties, FPS and the drawing canvas.</div></div>
<div class="ttc" id="anamespace_r_p_g_html_a384f30c4af9e6144612a638236ae0a79"><div class="ttname"><a href="namespace_r_p_g.html#a384f30c4af9e6144612a638236ae0a79">RPG::loadConfiguration</a></div><div class="ttdeci">std::map&lt; std::string, std::string &gt; loadConfiguration(char *sectionName, char *filename=NULL)</div><div class="ttdoc">Returns a std::map containing configuration from an INI file.</div></div>
</div><!-- fragment --><p>To try it, we just need to put the compiled DLL into the <code>DynPlugins</code> folder (if it isn't already there). Then we need to get some icons. For testing, I made some very simple 16x16 icons and put them into the <code>Picture</code> folder.</p>
<p>Then we need to open our DynRPG.ini and put the filenames in it, like this: </p><div class="fragment"><div class="line">[condition_icons]</div>
<div class="line">Condition2=Picture\poison.png</div>
<div class="line">Condition3=Picture\blind.png</div>
<div class="line">Condition5=Picture\berserk.png</div>
<div class="line">Condition6=Picture\confused.png</div>
<div class="line">Condition7=Picture\sleep.png</div>
</div><!-- fragment --><p>And hey presto, this is what we get:</p>
<div class="image"><img src="screen_condition_icons.png" alt="" class="inline"/></div><p>You can download the source code as well as the finished plugin <a href="condition_icons.rar">here</a>.</p>
<h1><a class="anchor" id="sdk_what_next"></a>
What next?</h1>
<p>You may now start developing your own plugins. You may first take a look at the <a class="el" href="group__callbacks.html">Callbacks</a>, the <a class="el" href="group__game__objects.html">Game objects</a>, and the members of the <a class="el" href="namespace_r_p_g.html" title="The one and only namespace in which all DynRPG classes, variables and functions reside,...">RPG</a> namespace, to get an overview of what is possible and how to get to the result you want. Then, you might start with something easy (like a DynRPG-based version of the <a href="http://cherrytree.at/download/?did=19">PicPointerPatch</a> - hint: take a look at <a class="el" href="group__callbacks.html#gacc31ffa472b1c78134e9d29a08a8bdc6">onEventCommand</a>, <a class="el" href="class_r_p_g_1_1_event_script_line.html" title="Represents an event script line.">RPG::EventScriptLine</a> and <a class="el" href="group__game__objects.html#gab62db73d3f0f5384af6b16901ec73eb2">RPG::variables</a>), then expand your knowledge until you can do nearly everything you want... or something like that. :-)</p>
<p><b>Yes, I know, I am just throwing you out into the wilderness. Sorry for not providing you more examples how to use all the features. I just had no time for it yet. If you are clever, you will probably be able to create something useful with what you got in this documentation anyway. If not, more examples will come. I will create nice plugins and publish them with source code, etc.</b></p>
<p>Oh, and don't forget to read and follow the <a class="el" href="guidelines.html">Rules and guidelines for plugin developers</a>!</p>
<p>By the way: If you want to publish your plugin, it would be nice if you would publish the source code too.</p>
<p>Have fun!<br  />
Best regards, Cherry </p>
</div></div><!-- contents -->
</div><!-- PageDoc -->
<!-- HTML footer for doxygen 1.10.0-->
<!-- start footer part -->
<hr class="footer" />
<address class="footer"><small>
    Generated by&#160;<a href="https://www.doxygen.org/index.html"><img class="footer" src="doxygen.svg"
        width="104" height="31" alt="doxygen" /></a> 1.12.0
  </small></address>
</body>
</html>
